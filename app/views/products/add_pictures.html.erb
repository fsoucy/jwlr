<div class="pan_cropper">
  <div class="inner_pan_cropper">
    <% if @picture.nil? %>
      <% link = new_picture_user_url(current_user.id) + "?product_id=" + @product.id.to_s %>
      <a href="<%= link %>"><button class="pure-button pure-button-primary button-success">Upload gallery image</button>
      <% @product.user.pictures.each do |pic| %>
        <div class="choose_div">
          <%= image_tag pic.photo_cropped(:medium), class: "pad-box product_image pure-img" %>    
          <%= hidden_field_tag :pic_id, pic.id, class: "choose_picture_id" %>
          <button class="pure-button pure-button-primary choose_picture">Use image</button>
        </div>
      <% end %>
    <% else %>
      <div class="picture">
        <div class="modal-body">
          <%= image_tag @picture.photo(:original), :id => "image", :class => "my_cropper_img pan_cropper_img" %>
        </div>

        <%= form_tag add_cropped_product_path(@product.id), :method => "Post" %>
        <%= hidden_field_tag :x, 0 %>
        <%= hidden_field_tag :y, 0 %>
        <%= hidden_field_tag :width, 300 %>
        <%= hidden_field_tag :height, 300 %>
        <%= hidden_field_tag :rotate, 0 %>
        <%= hidden_field_tag :picture_id, @picture.id %>
        <%= hidden_field_tag :factor, @factor %>
    
        <div class="submit_the_form">
          <%= submit_tag "Done cropping", class: 'pure-button pure-button-primary' %>
          <%= link_to "Delete", @picture, method: :delete,
                                       data: { confirm: "Are you sure?" } %>
          <%= link_to "Cancel", @product %>
          <br>
          <br>
          <button id="rotate_ccw" class= "pure-button pure-button-primary" type="button">Rotate counterclockwise</button>
          <button id="rotate_cw" class= "pure-button pure-button-primary" type="button">Rotate clockwise</button>
          <br>
          <button class="pure-button button-error choose_picture_return" type="button">Go back</button>
        </div>
      </div>
    <% end %>
  </div>
</div>
